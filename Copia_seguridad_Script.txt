/*
*CREACION DE TIPOS
*/

/*TIPO CURSO*/

/*Declaracion y cuerpo del tipo CURSO*/
CREATE OR REPLACE TYPE CURSO_TYPE AS OBJECT(
    ID_CURSO NUMBER(4),
    DESCRIPCION VARCHAR2(60),
    NIVEL VARCHAR2(30),
    TURNO CHAR,
    CONSTRUCTOR FUNCTION CURSO_TYPE(ID_CURSO NUMBER, DESCRIPCION VARCHAR2, NIVEL VARCHAR2, TURNO CHAR) RETURN SELF AS RESULT
);

CREATE OR REPLACE TYPE BODY CURSO_TYPE AS
    CONSTRUCTOR FUNCTION CURSO_TYPE(ID_CURSO NUMBER, DESCRIPCION VARCHAR2, NIVEL VARCHAR2, TURNO CHAR) RETURN SELF AS RESULT AS
    BEGIN
        SELF.ID_CURSO := ID_CURSO;
        SELF.DESCRIPCION := DESCRIPCION;
        SELF.NIVEL := NIVEL;
        SELF.TURNO := TURNO;
        RETURN;
    END;
END;

/*TIPO ASIGNATURA*/

/*Declaracion del tipo ASIGNATURA*/
CREATE OR REPLACE TYPE ASIGNATURA_TYPE AS OBJECT(
    COD_ASIG NUMBER(4),
    NOMBRE VARCHAR2(80),
    TIPO CHAR
);

/*TIPO NOTA*/

/*Declaracion del tipo EVALUACION*/
CREATE OR REPLACE TYPE EVALUACION_VARRAY AS VARRAY(5) OF NUMBER(4,2);

/*Declaracion del tipo NOTA*/
CREATE OR REPLACE TYPE NOTA_TYPE AS OBJECT(
    ASIG REF ASIGNATURA,
    EVALUACION EVALUACION_VARRAY
);


/*TIPO ALUMNO*/
/*Declaracion  del varray CONTACTO (contiene hasta dos telefonos)*/
CREATE OR REPLACE TYPE CONTACTO_VARRAY AS VARRAY(2) OF VARCHAR2(15);

/*Declaracion del tipo DOMICILIO (tipo con la info relativa a una vivienda)*/
CREATE OR REPLACE TYPE DOMICILIO_TYPE AS OBJECT(
    DIRECCION VARCHAR2(50),
    POBLACION VARCHAR2(50),
    CODPOSTAL NUMBER(5),
    PROVINCIA VARCHAR2(40)
);

/*Declaracion del tipo PERSONA (ALUMNO heredara de este tipo)*/
CREATE OR REPLACE TYPE PERSONA_TYPE AS OBJECT(
    NOMBRE VARCHAR2(50),
    DOMICILIO DOMICILIO_TYPE,
    CONTACTO CONTACTO_VARRAY,
    FECHA_NAC DATE
)NOT FINAL;

/*Declaracion del tipo TABLA_ANID_NOTA*/
CREATE TYPE TABLA_ANID_NOTA AS TABLE OF NOTA_TYPE;

/*Declaracion del tipo ALUMNO*/
CREATE OR REPLACE TYPE ALUMNO_TYPE UNDER PERSONA_TYPE(
	DNI VARCHAR2(10),
    CURSO REF CURSO_TYPE,
    NOTA TABLA_ANID_NOTA
);


/*
*CREACION DE TABLAS DE OBJETOS
*/

/*TABLA CURSO*/
CREATE TABLE CURSO_TABLA OF CURSO_TYPE(
    ID_CURSO PRIMARY KEY
);

/*TABLA ALUMNO*/
CREATE TABLE ALUMNO_TABLA OF ALUMNO_TYPE(
    DNI PRIMARY KEY
)NESTED TABLE NOTA STORE AS NOTA_ANIDADA;

/*TABLA ASIGNATURA*/
CREATE TABLE ASIGNATURA_TABLA OF ASIGNATURA_TYPE(
    COD_ASIG PRIMARY KEY
);


